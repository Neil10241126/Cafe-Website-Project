import{b as H,s as J,k as G,l as c,z as K,o as w,c as x,d as s,g as o,m,H as Q,v as b,M as g,f as I,t as U,J as S,F as W,p as X,q as Y,O as Z}from"./index-_lywX8Fs.js";import{_ as k}from"./icons-ZEDulI2G.js";import{u as ss,a as ts}from"./useValidation-EDTxK0yn.js";import{_ as es}from"./plugin-vueexport-helper-x3n3nnut.js";const n=d=>(X("data-v-26b5e51b"),d=d(),Y(),d),os=k+"#user",as=k+"#key",ns={class:"container py-6"},ds={class:"row justify-content-center"},ls={class:"col-12 col-lg-8"},rs=n(()=>s("h3",{class:"fs-5 text-gray-800"},"帳號設定",-1)),is=n(()=>s("p",{class:"fs-8 text-gray-600 mb-4"},"管理您的個人資料，選項或帳戶設置。",-1)),cs={class:"card border-gray-400 mb-4"},ms=n(()=>s("div",{class:"card-header bg-secondary-tint px-4 p-3"},[s("h4",{class:"fs-8 text-gray-800 mb-0"},"您的個人資料")],-1)),us={class:"card-body bg-secondary-tint rounded-bottom p-4"},ps={class:"d-flex mb-3"},fs={for:"file-input",class:"drop-area"},_s={width:"55",height:"55",class:"text-gray-600"},bs=n(()=>s("use",{"xlink:href":os},null,-1)),gs=[bs],vs=n(()=>s("div",{class:"ms-3"},[s("p",{class:"fs-7 fw-semibold text-gray-800 mb-1"},"您的個人照片"),s("span",{class:"fs-8 text-gray-600"},"請使用約 130 像素大小的正方形圖片")],-1)),hs=n(()=>s("p",{class:"fs-7 fw-semibold text-gray-800 mb-1"},"您的名稱",-1)),ys=n(()=>s("span",{class:"fs-8 text-gray-600"},"可使用姓名、偏好暱稱",-1)),ws={class:"d-flex align-items-stretch mt-1"},xs=n(()=>s("div",{class:"card border-gray-400 mb-4"},[s("div",{class:"card-header bg-secondary-tint px-4 p-3"},[s("h4",{class:"fs-8 text-gray-800 mb-0"},"登入資訊")]),s("div",{class:"card-body bg-secondary-tint rounded-bottom p-4"},[s("div",{class:"d-flex align-items-center"},[s("span",{class:"border border-gray-400 rounded-circle p-1"},[s("svg",{width:"30",height:"30",class:"text-gray-800"},[s("use",{"xlink:href":as})])]),s("div",{class:"d-flex justify-content-between align-items-center flex-fill ms-3"},[s("div",null,[s("p",{class:"fs-7 fw-semibold text-gray-800 mb-0"},"您的密碼"),s("span",{class:"fs-8 text-gray-600"},"點選編輯來更新您的密碼")]),s("button",{type:"button",class:"fs-8 btn btn-outline-gray-800 border-gray-600 rounded-1 text-nowrap","data-bs-toggle":"modal","data-bs-target":"#editPasswordModal"}," 編輯 ")])])])],-1)),Is={class:"modal fade",id:"editPasswordModal"},Us={class:"modal-dialog"},Ss={class:"modal-content"},ks=n(()=>s("div",{class:"modal-header px-4"},[s("div",null,[s("h1",{class:"modal-title fs-6"},"更新您的密碼"),s("span",{class:"fs-8 text-gray-600"},"選擇一組新的密碼來確保您的帳戶安全")]),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),Rs={class:"modal-body px-4"},Vs={action:"#"},Cs={class:"mb-3"},As={class:"fs-7 fw-semibold text-gray-800 mb-1"},Ns={class:"text-danger fw-normal fs-8 ms-1"},Ms=n(()=>s("span",{class:"fs-8 text-gray-600"},"密碼長度至少 8 個字元",-1)),Ps={class:"mb-3"},js={class:"fs-7 fw-semibold text-gray-800 mb-1"},Ds={class:"text-danger fw-normal fs-8 ms-1"},Fs={class:"modal-footer px-4"},$s=n(()=>s("button",{type:"button",class:"btn btn-outline-gray-600 rounded-1 fs-8","data-bs-dismiss":"modal"}," 取消 ",-1)),Bs=["disabled"],Ls={__name:"SettingView",setup(d){const R=H(),{user:l}=J(R),{renderUpdateName:V,renderUpdatePassword:C}=Z(),A=G(),{apiResAlert:v,apiErrAlert:h}=A,{fileInputRef:N,imgViewRef:M,isImageUpload:P,uploadImg:j}=D();function D(){const a=c(null),t=c(null),e=c(!1);function f(){if(a.value.files.length){const _=URL.createObjectURL(a.value.files[0]);t.value.style.backgroundImage=`url(${_})`,e.value=!0}}return{fileInputRef:a,imgViewRef:t,isImageUpload:e,uploadImg:f}}const{rename:u,updateUserName:F}=$();function $(){const a=c();function t(){const{id:e}=l.value.userInfo,f={name:a.value};V(e,f).then(()=>{l.value.userInfo.name=a.value,v("更新成功")}).catch(_=>{h(_)})}return K(()=>{a.value=l.value.userInfo.name}),{rename:a,updateUserName:t}}async function B(){const{id:a}=l.value.userInfo,t={password:i.value};try{await C(a,t),v("更新成功")}catch(e){throw h(e),e}}const{settingSchema:L}=ss(),{defineField:y,handleSubmit:T,errors:r,meta:E}=ts({validationSchema:L}),[i,O]=y("password"),[p,q]=y("passwordConfirm"),z=T(async(a,{resetForm:t})=>{try{await B(),t()}catch{}});return(a,t)=>(w(),x(W,null,[s("div",ns,[s("div",ds,[s("div",ls,[s("div",null,[rs,is,s("div",cs,[ms,s("div",us,[s("div",ps,[s("label",fs,[s("input",{type:"file",id:"file-input",accept:"image/jpeg, image/png, image/webp",hidden:"",ref_key:"fileInputRef",ref:N,onChange:t[0]||(t[0]=e=>o(j)())},null,544),s("div",{class:"img-view",ref_key:"imgViewRef",ref:M},[m((w(),x("svg",_s,gs,512)),[[Q,!o(P)]])],512)]),vs]),s("div",null,[hs,ys,s("div",ws,[m(s("input",{type:"text",class:"form-control form-control-sm me-3","onUpdate:modelValue":t[1]||(t[1]=e=>g(u)?u.value=e:null)},null,512),[[b,o(u)]]),s("button",{type:"button",class:"fs-8 btn btn-outline-gray-800 border-gray-600 rounded-1 text-nowrap",onClick:t[2]||(t[2]=e=>o(F)())}," 更新 ")])])])]),xs])])])]),s("div",Is,[s("div",Us,[s("div",Ss,[ks,s("div",Rs,[s("form",Vs,[s("div",Cs,[s("p",As,[I(" 新的密碼 "),s("span",Ns,U(o(r).password),1)]),Ms,m(s("input",S({type:"password",class:["form-control form-control-sm mt-2",{"is-invalid":o(r).password}],placeholder:"請輸入密碼",autocomplete:"true","onUpdate:modelValue":t[3]||(t[3]=e=>g(i)?i.value=e:null)},o(O)),null,16),[[b,o(i)]])]),s("div",Ps,[s("p",js,[I(" 確認密碼 "),s("span",Ds,U(o(r).passwordConfirm),1)]),m(s("input",S({type:"password",class:["form-control form-control-sm mt-2",{"is-invalid":o(r).passwordConfirm}],placeholder:"請輸入相同密碼",autocomplete:"true","onUpdate:modelValue":t[4]||(t[4]=e=>g(p)?p.value=e:null)},o(q)),null,16),[[b,o(p)]])])])]),s("div",Fs,[$s,s("button",{type:"button",class:"btn btn-primary rounded-1 fs-8",disabled:!o(E).valid,onClick:t[5]||(t[5]=e=>o(z)())}," 更新 ",8,Bs)])])])])],64))}},zs=es(Ls,[["__scopeId","data-v-26b5e51b"]]);export{zs as default};
