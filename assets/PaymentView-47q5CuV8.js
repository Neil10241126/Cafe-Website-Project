import{L as st,u as at,k as ot,a as lt,s as nt,l as dt,z as ct,r as rt,o as r,c as p,e as S,d as t,w as T,F as A,j as q,m,U as D,g as s,J as u,M as _,t as l,v as y,f as c,G as it,n as pt,h as mt,p as ut,q as _t,O as ft}from"./index-2njM8VTU.js";import{u as bt,a as ht}from"./useValidation-erPOWDAl.js";import{A as yt}from"./AdView-91VUF8_-.js";import{C as vt}from"./CanvasCard-PV76ASod.js";import{_ as xt}from"./plugin-vueexport-helper-x3n3nnut.js";import"./AddButtonUi-St4YgJtp.js";const o=v=>(ut("data-v-2f3c2e34"),v=v(),_t(),v),gt={class:"container py-6"},wt={class:"nav justify-content-center align-items-center fs-8 mb-3"},kt={class:"nav-item"},Ct=o(()=>t("li",null,"/",-1)),Vt={class:"nav-item"},St=o(()=>t("div",{class:"d-flex justify-content-center align-items-center"},[t("h2",{class:"fs-4 lh-sm fw-semibold text-gray-800 mb-0"},"付款確認"),t("i",{class:"bi bi-credit-card fs-5 text-gray-800 ms-2"})],-1)),At=pt('<div class="container d-flex justify-content-center" data-v-2f3c2e34><ul class="list-unstyled d-flex border border-2 border-primary px-3 px-md-4 py-4 mb-0" style="border-style:dashed !important;" data-v-2f3c2e34><li class="text-center border border-2 border-primary py-2 px-2 px-md-4" data-v-2f3c2e34><p class="fs-md-6 fw-seimbold text-primary mb-2" data-v-2f3c2e34>Step 1</p><p class="fs-md-6 fw-seimbold text-primary mb-0 text-nowrap" data-v-2f3c2e34>確認商品</p></li><li class="text-center border border-2 border-primary py-2 px-2 px-md-4 mx-3 mx-md-4" data-v-2f3c2e34><p class="fs-md-6 fw-seimbold text-primary mb-2" data-v-2f3c2e34>Step 2</p><p class="fs-md-6 fw-seimbold text-primary mb-0 text-nowrap" data-v-2f3c2e34>填寫訂單</p></li><li class="text-center bg-primary py-2 px-2 px-md-4" data-v-2f3c2e34><p class="fs-md-6 fw-seimbold text-light mb-2" data-v-2f3c2e34>Step 3</p><p class="fs-md-6 fw-seimbold text-light mb-0 text-nowrap" data-v-2f3c2e34>結帳付款</p></li></ul></div>',1),jt={class:"container py-8"},Ut={class:"row justify-content-center d-none d-md-flex mb-5"},It={class:"col-12 col-lg-8"},Nt={class:"p-5 bg-secondary-light rounded",style:{"box-shadow":"0 4px 4px rgba(0, 0, 0, 0.25)"}},Rt={class:"table align-middle table-primary text-center"},$t=o(()=>t("thead",{class:"fs-6"},[t("tr",null,[t("th",null,"商品"),t("th",null,"品項"),t("th",null,"數量"),t("th",null,"價格")])],-1)),Mt=["src"],Tt={class:"text-gray-800 mb-1"},qt={class:"fs-8 text-gray-600"},Dt={class:"fw-semibold"},Bt={class:"d-md-none mb-5"},Ft={class:"row justify-content-center gy-5"},Lt={class:"col-12 col-lg-4"},Ot={class:"input-wrap"},Pt=o(()=>t("h3",{class:"fs-6 lh-base fw-bold text-gray-800 pb-4 mb-0"},"付款方式",-1)),Et={class:"list-group flex-row"},zt={class:"form-check form-check-inline"},Gt=o(()=>t("label",{class:"form-check-label fw-semibold",for:"creditCard"},"信用卡",-1)),Jt={class:"form-check form-check-inline"},Xt=o(()=>t("label",{class:"form-check-label fw-semibold",for:"cost"},"貨到付款",-1)),Ht={class:"fs-8 text-danger"},Kt={class:"tab-content"},Qt={class:"tab-pane mt-4",id:"credit-list"},Wt={class:"mb-4"},Yt=o(()=>t("label",{for:"credit-name",class:"form-label fw-semibold"},[c(" 持卡人姓名 "),t("span",{class:"text-danger fs-6 align-bottom"},"⁎")],-1)),Zt={class:"fs-8 text-danger"},te={class:"mb-4"},ee=o(()=>t("label",{for:"credit-number",class:"form-label fw-semibold"},[c(" 信用卡號碼 "),t("span",{class:"text-danger fs-6 align-bottom"},"⁎")],-1)),se={class:"fs-8 text-danger"},ae={class:"row gx-2 gx-md-4"},oe={class:"col-4"},le=o(()=>t("label",{for:"credit-month",class:"form-label fw-semibold"},[c(" 期限 "),t("span",{class:"text-danger fs-6 align-bottom"},"⁎")],-1)),ne={class:"fs-8 text-danger"},de={class:"col-4"},ce=o(()=>t("label",{for:"credit-month",class:"form-label invisible"},[t("span",{class:"text-danger fs-6 align-bottom"},"⁎")],-1)),re={class:"fs-8 text-danger"},ie={class:"col-4"},pe=o(()=>t("label",{for:"credit-cvv",class:"form-label fw-semibold"},[c(" 安全碼 "),t("span",{class:"text-danger fs-6 align-bottom"},"⁎")],-1)),me={class:"fs-8 text-danger"},ue=o(()=>t("div",{class:"tab-pane",id:"cost-list"},null,-1)),_e={class:"col-12 col-lg-4"},fe={class:"input-wrap"},be={class:"list-unstyled mb-0"},he={class:"fs-6 text-gray-800 d-flex justify-content-between py-2"},ye=o(()=>t("span",{class:"fw-semibold text-nowrap me-4"},"姓名",-1)),ve={class:"fs-6 text-gray-800 d-flex justify-content-between py-2"},xe=o(()=>t("span",{class:"fw-semibold text-nowrap me-4"},"電話",-1)),ge={class:"fs-6 text-gray-800 d-flex justify-content-between py-2"},we=o(()=>t("span",{class:"fw-semibold text-nowrap me-4"},"電子郵件",-1)),ke={class:"text-break text-end"},Ce={class:"fs-6 text-gray-800 d-flex justify-content-between pt-2 pb-3"},Ve=o(()=>t("span",{class:"fw-semibold text-nowrap me-4"},"收件地址",-1)),Se={class:"text-end text-wrap"},Ae={class:"fs-5 fw-bold text-gray-800 border-top border-2 border-dark d-flex justify-content-between pt-3 pb-4"},je=o(()=>t("span",null,"總金額",-1)),Ue={class:"text-danger"},Ie={key:0,class:"mb-1"},Ne={key:0,class:"text-danger"},Re=o(()=>t("i",{class:"bi bi-exclamation-circle ms-!"},null,-1)),$e={key:1,class:"text-success"},Me=o(()=>t("i",{class:"bi bi-check-circle ms-1"},null,-1)),Te=o(()=>t("i",{class:"bi bi-chevron-right ms-1"},null,-1)),qe={__name:"PaymentView",setup(v){const g=st(),B=at(),F=ot(),{apiResAlert:L,apiErrAlert:j}=F,O=lt(),{finalTotal:P}=nt(O),{fetchOrder:E,fetchCheckout:z}=ft(),i=dt({});function G(){E(g.params.orderId).then(d=>{i.value=d.data.order}).catch(d=>j(d.response.data.message))}function J(){z(g.params.orderId).then(d=>{L(d.data.message),B.push(`/checkout/${g.params.orderId}`)}).catch(d=>j(d.response.data.message))}ct(()=>{G()});const{paymentSchema:X}=bt(),{handleSubmit:H,defineField:f,errors:n,meta:U}=ht({validationSchema:X}),[b,I]=f("payment.type"),[w,K]=f("payment.creditCard.name"),[x,Q]=f("payment.creditCard.number"),[k,W]=f("payment.creditCard.month"),[C,Y]=f("payment.creditCard.day"),[V,Z]=f("payment.creditCard.cvv"),tt=H(()=>{J()});function et(d){let a=d.target.value.replace(/\D/g,"");a.length>16&&(a=a.slice(0,16));const h=a.replace(/(\d{4})(?=\d)/g,"$1 ");d.target.value=h,x.value=h}return(d,a)=>{var N,R,$,M;const h=rt("RouterLink");return r(),p(A,null,[S(yt),t("div",gt,[t("ul",wt,[t("li",kt,[S(h,{to:"/",class:"nav-link link-gray-800 text-decoration-underline link-offset-1 px-2 py-0"},{default:T(()=>[c(" 首頁 ")]),_:1})]),Ct,t("li",Vt,[S(h,{to:"#",class:"nav-link link-gray-800 px-2 py-0 disabled"},{default:T(()=>[c("結帳")]),_:1})])]),St]),At,t("div",jt,[t("div",Ut,[t("div",It,[t("div",Nt,[t("table",Rt,[$t,t("tbody",null,[(r(!0),p(A,null,q(i.value.products,e=>(r(),p("tr",{key:e.id},[t("td",null,[t("img",{src:e.product.imageUrl,class:"mx-auto my-2",alt:"",width:"100"},null,8,Mt)]),t("td",null,[t("p",Tt,l(e.product.title),1),t("span",qt,l(e.product.content),1)]),t("td",null,l(`X${e.qty}`),1),t("td",Dt,l(`NT$ ${e.total}`),1)]))),128))])])])])]),t("div",Bt,[(r(!0),p(A,null,q(i.value.products,e=>(r(),mt(vt,{class:"mb-3",editor:!1,key:e.id,title:e.product.title,price:e.total,qty:e.qty,img_url:e.product.imageUrl,content:e.product.content},null,8,["title","price","qty","img_url","content"]))),128))]),t("div",Ft,[t("div",Lt,[t("div",Ot,[Pt,t("div",Et,[t("div",zt,[m(t("input",u({class:"form-check-input",type:"radio",name:"payment",id:"creditCard",value:"信用卡","data-bs-toggle":"list",href:"#credit-list","onUpdate:modelValue":a[0]||(a[0]=e=>_(b)?b.value=e:null)},s(I)),null,16),[[D,s(b)]]),Gt]),t("div",Jt,[m(t("input",u({class:"form-check-input",type:"radio",name:"payment",id:"cost",value:"貨到付款","data-bs-toggle":"list",href:"#cost-list","onUpdate:modelValue":a[1]||(a[1]=e=>_(b)?b.value=e:null)},s(I)),null,16),[[D,s(b)]]),Xt]),t("span",Ht,l(s(n)["payment.type"]),1)]),t("div",Kt,[t("div",Qt,[t("div",Wt,[Yt,m(t("input",u({type:"text",class:["form-control",{"is-invalid":s(n)["payment.creditCard.name"]}],id:"credit-name",placeholder:"請輸入持卡本人姓名","onUpdate:modelValue":a[2]||(a[2]=e=>_(w)?w.value=e:null)},s(K)),null,16),[[y,s(w)]]),t("span",Zt,l(s(n)["payment.creditCard.name"]),1)]),t("div",te,[ee,m(t("input",u({type:"tel",class:["form-control",{"is-invalid":s(n)["payment.creditCard.number"]}],id:"credit-number",placeholder:"請輸入卡片16位號碼","onUpdate:modelValue":a[3]||(a[3]=e=>_(x)?x.value=e:null)},s(Q),{onInput:a[4]||(a[4]=e=>et(e))}),null,16),[[y,s(x)]]),t("span",se,l(s(n)["payment.creditCard.number"]),1)]),t("div",ae,[t("div",oe,[le,m(t("input",u({type:"tel",class:["form-control",{"is-invalid":s(n)["payment.creditCard.month"]}],id:"credit-month",placeholder:"MM",maxlength:"2","onUpdate:modelValue":a[5]||(a[5]=e=>_(k)?k.value=e:null)},s(W)),null,16),[[y,s(k)]]),t("span",ne,l(s(n)["payment.creditCard.month"]),1)]),t("div",de,[ce,m(t("input",u({type:"tel",class:["form-control",{"is-invalid":s(n)["payment.creditCard.day"]}],id:"credit-month",placeholder:"DD",maxlength:"2","onUpdate:modelValue":a[6]||(a[6]=e=>_(C)?C.value=e:null)},s(Y)),null,16),[[y,s(C)]]),t("span",re,l(s(n)["payment.creditCard.day"]),1)]),t("div",ie,[pe,m(t("input",u({type:"tel",class:["form-control",{"is-invalid":s(n)["payment.creditCard.cvv"]}],id:"credit-cvv",placeholder:"CVV",maxlength:"3","onUpdate:modelValue":a[7]||(a[7]=e=>_(V)?V.value=e:null)},s(Z)),null,16),[[y,s(V)]]),t("span",me,l(s(n)["payment.creditCard.cvv"]),1)])])]),ue])])]),t("div",_e,[t("div",fe,[t("ul",be,[t("li",he,[ye,t("span",null,l((N=i.value.user)==null?void 0:N.name),1)]),t("li",ve,[xe,t("span",null,l((R=i.value.user)==null?void 0:R.tel),1)]),t("li",ge,[we,t("span",ke,l(($=i.value.user)==null?void 0:$.email),1)]),t("li",Ce,[Ve,t("span",Se,l((M=i.value.user)==null?void 0:M.address),1)]),t("li",Ae,[je,t("span",Ue,l(`NT$ ${s(P)}`),1)])]),s(U).touched?(r(),p("div",Ie,[s(U).valid?(r(),p("span",$e,[c(" 欄位已完成 "),Me])):(r(),p("span",Ne,[c(" 欄位未完成 "),Re]))])):it("",!0),t("button",{type:"button",class:"btn btn-primary w-100",onClick:a[8]||(a[8]=e=>s(tt)())},[c(" 確認付款 "),Te])])])])])],64)}}},Ee=xt(qe,[["__scopeId","data-v-2f3c2e34"]]);export{Ee as default};
