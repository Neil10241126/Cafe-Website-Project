import{r as I,C as re,f as w,h as k,i as e,v as _,L as ue,H as U,m as j,z as K,A as O,J,o as me,l as s,k as g,t as m,x,N as p,O as f,$ as pe,j as fe,F as _e,Q as he}from"./index-_lOFy3Cn.js";import{_ as D}from"./icons-P9OnizTI.js";import{u as ge,a as ve}from"./useValidation-76tI4OoK.js";import{M as be}from"./modal-C8Az8Bl6.js";import{_ as H}from"./plugin-vueexport-helper-x3n3nnut.js";import"./selector-engine-B6RTJdBp.js";const Q=r=>(K("data-v-af5d6f14"),r=r(),O(),r),xe=D+"#plus",ye=D+"#trash3",we={width:"36",height:"36",class:"img-icons"},ke=Q(()=>e("use",{"xlink:href":xe},null,-1)),Ue=[ke],Ie={class:"tool-list"},De=Q(()=>e("svg",{width:"24",height:"24"},[e("use",{"xlink:href":ye})],-1)),Se=[De],$e={__name:"UploaderUi",emits:["sendImageData","removeImageData"],setup(r,{emit:M}){const n=I(null),y=I(null),d=I({isUploaded:!1,viewLink:"",fileName:"",fileSize:0,fileType:"",data:{}}),$=M;function V(){if(n.value.files.length){const{name:v,size:l,type:h}=n.value.files[0];d.value={isUploaded:!0,viewLink:URL.createObjectURL(n.value.files[0]),fileName:v,fileSize:l,fileType:h.split("/").pop(),data:n.value.files[0]},y.value.style.backgroundImage=`url(${d.value.viewLink})`}}function P(v){const{type:l}=v.dataTransfer.files[0];l.split("/").shift()==="image"&&(n.value.files=v.dataTransfer.files,V())}function z(){n.value={},d.value={isUploaded:!1,viewLink:"",fileName:"",fileSize:0,fileType:"",data:{}},y.value.style.backgroundImage="",$("removeImageData")}return re(d,()=>{$("sendImageData",d.value)}),(v,l)=>(w(),k("label",{for:"file-input",class:U(["drop-area",[{"border-netural-800":d.value.isUploaded},{show:d.value.isUploaded}]]),onDrop:l[2]||(l[2]=j(h=>P(h),["prevent"])),onDragover:l[3]||(l[3]=j(()=>{},["prevent"]))},[e("input",{type:"file",id:"file-input",accept:"image/jpeg, image/png, image/webp",hidden:"",ref_key:"fileInputRef",ref:n,onChange:l[0]||(l[0]=h=>V())},null,544),e("div",{class:"img-view",ref_key:"imgViewRef",ref:y},[_((w(),k("svg",we,Ue,512)),[[ue,!d.value.isUploaded]]),e("div",{class:U(["tool",{show:d.value.isUploaded}])},[e("div",Ie,[e("a",{href:"#",class:"tool-icon",onClick:l[1]||(l[1]=j(h=>z(),["prevent"]))},Se)])],2)],512)],34))}},Ve=H($e,[["__scopeId","data-v-af5d6f14"]]),i=r=>(K("data-v-2e2d0600"),r=r(),O(),r),Me=D+"#check-circle",Pe=D+"#box-arrow-up-right",ze=D+"#file-text",Te=D+"#image",Ae={class:"card"},Ne=i(()=>e("div",{class:"card-header"},"Featured",-1)),Ce={class:"card-body"},Fe={class:"table"},Ee=i(()=>e("thead",null,[e("tr",null,[e("th",{scope:"col"},"商品標題"),e("th",{scope:"col",class:"text-end"},"類別"),e("th",{scope:"col",class:"text-end"},"售價(NTD)"),e("th",{scope:"col",class:"text-end"},"是否啟用"),e("th",{scope:"col",class:"text-end"},"功能")])],-1)),Le={class:"align-middle"},Re=i(()=>e("th",{scope:"row"},"1",-1)),Be=i(()=>e("td",{class:"text-end"},[e("span",{class:"badge rounded-pill text-bg-primary py-2 fw-normal"},"淺烘焙")],-1)),je=i(()=>e("td",{class:"text-end"},"399",-1)),Ge={class:"text-end"},Je={width:"20",height:"20"},Ke={key:0,"xlink:href":Me,class:"text-success"},Oe={class:"text-end"},He=i(()=>e("svg",{width:"16",height:"16",class:"d-flex"},[e("use",{"xlink:href":Pe})],-1)),Qe=[He],We={class:"modal-dialog"},qe={class:"modal-content","data-bs-theme":"dark"},Xe=i(()=>e("div",{class:"modal-header bg-netural-800 text-netural-100"},[e("h1",{class:"modal-title fs-5"},"新增商品"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),Ye={class:"modal-body","data-bs-theme":"light"},Ze=i(()=>e("div",{class:"list-group d-inline-flex flex-row"},[e("a",{href:"#list-content",class:"list-group-item list-group-item-action d-flex align-items-center active","data-bs-toggle":"list"},[e("svg",{width:"18",height:"18"},[e("use",{"xlink:href":ze})]),e("span",{class:"text-nowrap ms-2"},"內容")]),e("a",{href:"#list-images",class:"list-group-item list-group-item-action d-flex align-items-center","data-bs-toggle":"list"},[e("svg",{width:"18",height:"18"},[e("use",{"xlink:href":Te})]),e("span",{class:"text-nowrap ms-2"},"圖片")])],-1)),es={class:"tab-content"},ss={class:"tab-pane fade show active p-3 border",id:"list-content"},ts={action:"#"},os={class:"row gx-3 mb-3"},ls={class:"col-8"},as={for:"title",class:"form-label fs-8"},is={class:"text-danger ms-1"},ns={class:"col-4"},ds={for:"category",class:"form-label fs-8"},cs={class:"text-danger ms-1"},rs={class:"row gx-3 mb-3"},us={class:"col-4"},ms={for:"origin-price",class:"form-label fs-8"},ps={class:"text-danger ms-1"},fs={class:"col-4"},_s={for:"price",class:"form-label fs-8"},hs={class:"text-danger ms-1"},gs={class:"col-4"},vs={for:"unit",class:"form-label fs-8"},bs={class:"text-danger ms-1"},xs={class:"mb-3"},ys={for:"content",class:"form-label fs-8"},ws={class:"text-danger ms-1"},ks={class:"mb-3"},Us={for:"description",class:"form-label fs-8"},Is={class:"text-danger ms-1"},Ds={class:"form-check form-switch"},Ss=i(()=>e("label",{class:"form-check-label fs-8",for:"isEnable"},"是否啟用",-1)),$s={class:"tab-pane fade p-3 border",id:"list-images"},Vs={class:"row"},Ms={class:"col-3"},Ps=i(()=>e("label",{class:"form-label fs-8"},"主要圖片",-1)),zs={class:"col-9"},Ts={class:"d-flex flex-column h-100"},As={class:"fs-8 lh-base mb-2"},Ns={class:"mb-1"},Cs=i(()=>e("p",{class:"fs-8 text-muted"},"限制 : 圖片檔案不可大於 3MB",-1)),Fs=i(()=>e("span",null,null,-1)),Es={class:"mt-auto d-flex justify-content-between"},Ls={class:"me-2"},Rs={width:"16",height:"16"},Bs=["xlink:href"],js=i(()=>e("div",{class:"spinner-border spinner-grow-sm ms-1",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)),Gs={class:"modal-footer bg-netural-800"},Js=i(()=>e("button",{type:"button",class:"btn btn-outline-netural-300","data-bs-dismiss":"modal"}," 關閉 ",-1)),Ks={__name:"AdminProducts",setup(r){const{fetchUpload:M}=he(),{imageData:n,sizeCheck:y,formatSize:d,getEmitData:$,removeFiledImageUrl:V,upload:P}=z();function z(){const c=I({isUploaded:!1,viewLink:"",fileName:"",fileSize:0,fileType:"",data:{}}),t=J(()=>c.value.fileSize>3145728),o=J(()=>{const b=c.value.fileSize/1024;return b>1024?`${(b/1024).toFixed(2)} MB`:`${b.toFixed(2)} KB`});function ne(b){c.value=b}function de(){S.value=""}function ce(){const{data:b}=c.value,G=new FormData;G.append("file-to-upload",b),M(G).then(B=>{S.value=B.data.imageUrl}).catch(B=>console.log("fetch err: ",B))}return{imageData:c,sizeCheck:t,formatSize:o,getEmitData:ne,removeFiledImageUrl:de,upload:ce}}const{refProductModal:v,openModal:l}=h();function h(){const c=I(null),t=I("");function o(){t.value.show()}return me(()=>{t.value=new be(c.value),t.value.show()}),{refProductModal:c,openModal:o}}const{addProductSchema:W}=ge(),{defineField:u,handleSubmit:q,errors:a}=ve({validationSchema:W}),[T,X]=u("title"),[A,Y]=u("category"),[N,Z]=u("originPrice"),[C,ee]=u("price"),[F,se]=u("unit"),[E,te]=u("content"),[L,oe]=u("desc"),[R,le]=u("isEnabled"),[S,ae]=u("imageUrl"),ie=q(c=>{console.log(c)});return(c,t)=>(w(),k(_e,null,[e("div",Ae,[Ne,e("div",Ce,[e("table",Fe,[Ee,e("tbody",Le,[e("tr",null,[Re,Be,je,e("td",Ge,[(w(),k("svg",Je,[(w(),k("use",Ke))]))]),e("td",Oe,[e("button",{type:"button",class:"btn btn-netural-800 rounded-1 py-1 px-2",onClick:t[0]||(t[0]=o=>s(l)())},Qe)])])])])])]),e("div",{class:"modal fade",id:"productModal",ref_key:"refProductModal",ref:v},[e("div",We,[e("div",qe,[Xe,e("div",Ye,[Ze,e("div",es,[e("div",ss,[e("form",ts,[e("div",os,[e("div",ls,[e("label",as,[g("商品標題"),e("span",is,m(s(a).title),1)]),_(e("input",p({type:"text",class:["form-control form-control-sm",{"is-invalid":s(a).title}],id:"title",placeholder:"請輸入商品標題","onUpdate:modelValue":t[1]||(t[1]=o=>f(T)?T.value=o:null)},s(X)),null,16),[[x,s(T)]])]),e("div",ns,[e("label",ds,[g("類別"),e("span",cs,m(s(a).category),1)]),_(e("input",p({type:"text",class:["form-control form-control-sm",{"is-invalid":s(a).category}],id:"category",placeholder:"請輸入類別","onUpdate:modelValue":t[2]||(t[2]=o=>f(A)?A.value=o:null)},s(Y)),null,16),[[x,s(A)]])])]),e("div",rs,[e("div",us,[e("label",ms,[g("原價"),e("span",ps,m(s(a).originPrice),1)]),_(e("input",p({type:"number",class:["form-control form-control-sm",{"is-invalid":s(a).originPrice}],id:"origin-price",placeholder:"請輸入原價","onUpdate:modelValue":t[3]||(t[3]=o=>f(N)?N.value=o:null)},s(Z)),null,16),[[x,s(N)]])]),e("div",fs,[e("label",_s,[g("售價"),e("span",hs,m(s(a).price),1)]),_(e("input",p({type:"number",class:["form-control form-control-sm",{"is-invalid":s(a).price}],id:"price",placeholder:"請輸入售價","onUpdate:modelValue":t[4]||(t[4]=o=>f(C)?C.value=o:null)},s(ee)),null,16),[[x,s(C)]])]),e("div",gs,[e("label",vs,[g("單位"),e("span",bs,m(s(a).unit),1)]),_(e("input",p({type:"text",class:["form-control form-control-sm",{"is-invalid":s(a).unit}],id:"unit",placeholder:"請輸入單位","onUpdate:modelValue":t[5]||(t[5]=o=>f(F)?F.value=o:null)},s(se)),null,16),[[x,s(F)]])])]),e("div",xs,[e("label",ys,[g("內容"),e("span",ws,m(s(a).content),1)]),_(e("input",p({type:"text",class:["form-control form-control-sm",{"is-invalid":s(a).content}],id:"content",placeholder:"請輸入商品內容","onUpdate:modelValue":t[6]||(t[6]=o=>f(E)?E.value=o:null)},s(te)),null,16),[[x,s(E)]])]),e("div",ks,[e("label",Us,[g("描述"),e("span",Is,m(s(a).desc),1)]),_(e("textarea",p({class:["form-control form-control-sm",{"is-invalid":s(a).desc}],id:"description",rows:"3",placeholder:"請輸入商品描述","onUpdate:modelValue":t[7]||(t[7]=o=>f(L)?L.value=o:null)},s(oe)),null,16),[[x,s(L)]])]),e("div",Ds,[_(e("input",p({class:"form-check-input",type:"checkbox",checked:"",id:"isEnable","onUpdate:modelValue":t[8]||(t[8]=o=>f(R)?R.value=o:null)},s(le)),null,16),[[pe,s(R)]]),Ss])])]),e("div",$s,[e("div",Vs,[e("div",Ms,[e("div",null,[Ps,fe(Ve,p({onSendImageData:s($),onRemoveImageData:s(V),modelValue:s(S),"onUpdate:modelValue":t[9]||(t[9]=o=>f(S)?S.value=o:null)},s(ae)),null,16,["onSendImageData","onRemoveImageData","modelValue"])])]),e("div",zs,[e("div",Ts,[e("div",null,[e("h5",As,"檔名 : "+m(s(n).fileName),1),e("div",Ns,[e("span",{class:U(["badge text-bg-netural-900",{"bg-success":s(n).fileType==="jpeg"}])},"JPG",2),e("span",{class:U(["badge text-bg-netural-900 ms-1",{"bg-success":s(n).fileType==="png"}])},"PNG",2),e("span",{class:U(["badge text-bg-netural-900 ms-1",{"bg-success":s(n).fileType==="webp"}])},"WEBP",2)]),Cs,Fs]),e("div",Es,[e("div",{class:U(["d-flex align-items-center text-success",{"text-danger":s(y)}])},[e("span",Ls,m(s(d)),1),(w(),k("svg",Rs,[e("use",{"xlink:href":`/public/icons/icons.svg#${s(y)?"x-circle":"check-circle"}`},null,8,Bs)]))],2),e("button",{type:"button",class:"btn btn-sm btn-success",onClick:t[10]||(t[10]=o=>s(P)())},[g(" 點擊上傳 "),js])])])])])])])]),e("div",Gs,[Js,e("button",{type:"button",class:"btn btn-success",onClick:t[11]||(t[11]=o=>s(ie)())},"儲存")])])])],512)],64))}},Ys=H(Ks,[["__scopeId","data-v-2e2d0600"]]);export{Ys as default};
