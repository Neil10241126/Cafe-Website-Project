import{L as at,u as ot,k as lt,a as nt,s as dt,l as rt,z as it,r as ct,o as i,c as p,e as S,d as t,w as M,F as A,j as T,m,U as q,g as s,J as u,M as _,t as l,v as y,f as r,G as pt,n as mt,h as ut,p as _t,q as ft,O as bt}from"./index-e-kLE5WB.js";import{u as ht,a as yt}from"./useValidation--MndOpIM.js";import{A as vt}from"./AdView-UsHZIR_P.js";import{C as xt}from"./CanvasCard-eQ9LCJHj.js";import{_ as gt}from"./plugin-vueexport-helper-x3n3nnut.js";import"./AddButtonUi-mg37a2j7.js";const o=v=>(_t("data-v-843fa512"),v=v(),ft(),v),wt={class:"container py-6"},kt={class:"nav justify-content-center align-items-center fs-8 mb-3"},Ct={class:"nav-item"},Vt=o(()=>t("li",null,"/",-1)),St={class:"nav-item"},At=o(()=>t("div",{class:"d-flex justify-content-center align-items-center"},[t("h2",{class:"fs-4 lh-sm fw-semibold text-gray-800 mb-0"},"付款確認"),t("i",{class:"bi bi-credit-card fs-5 text-gray-800 ms-2"})],-1)),jt=mt('<div class="container d-flex justify-content-center" data-v-843fa512><ul class="list-unstyled d-flex border border-2 border-primary px-3 px-md-4 py-4 mb-0" style="border-style:dashed !important;" data-v-843fa512><li class="text-center border border-2 border-primary py-2 px-2 px-md-4" data-v-843fa512><p class="fs-md-6 fw-seimbold text-primary mb-2" data-v-843fa512>Step 1</p><p class="fs-md-6 fw-seimbold text-primary mb-0 text-nowrap" data-v-843fa512>確認商品</p></li><li class="text-center border border-2 border-primary py-2 px-2 px-md-4 mx-3 mx-md-4" data-v-843fa512><p class="fs-md-6 fw-seimbold text-primary mb-2" data-v-843fa512>Step 2</p><p class="fs-md-6 fw-seimbold text-primary mb-0 text-nowrap" data-v-843fa512>填寫訂單</p></li><li class="text-center bg-primary py-2 px-2 px-md-4" data-v-843fa512><p class="fs-md-6 fw-seimbold text-light mb-2" data-v-843fa512>Step 3</p><p class="fs-md-6 fw-seimbold text-light mb-0 text-nowrap" data-v-843fa512>結帳付款</p></li></ul></div>',1),Ut={class:"container py-8"},It={class:"row justify-content-center d-none d-md-flex mb-5"},Nt={class:"col-12 col-lg-8"},Rt={class:"p-5 bg-secondary-light rounded",style:{"box-shadow":"0 4px 4px rgba(0, 0, 0, 0.25)"}},$t={class:"table align-middle table-primary text-center"},Dt=o(()=>t("thead",{class:"fs-6"},[t("tr",null,[t("th",null,"商品"),t("th",null,"品項"),t("th",null,"數量"),t("th",null,"價格")])],-1)),Mt=["src"],Tt={class:"text-gray-800 mb-1"},qt={class:"fs-8 text-gray-600"},Bt={class:"fw-semibold"},Ft={class:"d-md-none mb-5"},Lt={class:"row justify-content-center gy-5"},Pt={class:"col-12 col-lg-4"},Ot={class:"input-wrap"},Et=o(()=>t("h3",{class:"fs-6 lh-base fw-bold text-gray-800 pb-4 mb-0"},"付款方式",-1)),zt={class:"list-group flex-row"},Gt={class:"form-check form-check-inline"},Jt=o(()=>t("label",{class:"form-check-label fw-semibold",for:"creditCard"},"信用卡",-1)),Xt={class:"form-check form-check-inline"},Ht=o(()=>t("label",{class:"form-check-label fw-semibold",for:"cost"},"貨到付款",-1)),Kt={class:"fs-8 text-danger"},Qt={class:"tab-content"},Wt={class:"tab-pane mt-4",id:"credit-list"},Yt={class:"mb-4"},Zt=o(()=>t("label",{for:"credit-name",class:"form-label fw-semibold"},[r(" 持卡人姓名 "),t("span",{class:"text-danger fs-6 align-bottom"},"⁎")],-1)),te={class:"fs-8 text-danger"},ee={class:"mb-4"},se=o(()=>t("label",{for:"credit-number",class:"form-label fw-semibold"},[r(" 信用卡號碼 "),t("span",{class:"text-danger fs-6 align-bottom"},"⁎")],-1)),ae={class:"fs-8 text-danger"},oe={class:"row gx-2 gx-md-4"},le={class:"col-4"},ne=o(()=>t("label",{for:"credit-month",class:"form-label fw-semibold"},[r(" 期限 "),t("span",{class:"text-danger fs-6 align-bottom"},"⁎")],-1)),de={class:"fs-8 text-danger"},re={class:"col-4"},ie=o(()=>t("label",{for:"credit-month",class:"form-label invisible"},[t("span",{class:"text-danger fs-6 align-bottom"},"⁎")],-1)),ce={class:"fs-8 text-danger"},pe={class:"col-4"},me=o(()=>t("label",{for:"credit-cvv",class:"form-label fw-semibold"},[r(" 安全碼 "),t("span",{class:"text-danger fs-6 align-bottom"},"⁎")],-1)),ue={class:"fs-8 text-danger"},_e=o(()=>t("div",{class:"tab-pane",id:"cost-list"},null,-1)),fe={class:"col-12 col-lg-4"},be={class:"input-wrap"},he={class:"list-unstyled mb-0"},ye={class:"fs-6 text-gray-800 d-flex justify-content-between py-2"},ve=o(()=>t("span",{class:"fw-semibold text-nowrap me-4"},"姓名",-1)),xe={class:"fs-6 text-gray-800 d-flex justify-content-between py-2"},ge=o(()=>t("span",{class:"fw-semibold text-nowrap me-4"},"電話",-1)),we={class:"fs-6 text-gray-800 d-flex justify-content-between py-2"},ke=o(()=>t("span",{class:"fw-semibold text-nowrap me-4"},"電子郵件",-1)),Ce={class:"text-break text-end"},Ve={class:"fs-6 text-gray-800 d-flex justify-content-between pt-2 pb-3"},Se=o(()=>t("span",{class:"fw-semibold text-nowrap me-4"},"收件地址",-1)),Ae={class:"text-end text-wrap"},je={class:"fs-5 fw-bold text-gray-800 border-top border-2 border-dark d-flex justify-content-between pt-3 pb-4"},Ue=o(()=>t("span",null,"總金額",-1)),Ie={class:"text-danger"},Ne={key:0,class:"mb-1"},Re={key:0,class:"text-danger"},$e=o(()=>t("i",{class:"bi bi-exclamation-circle ms-!"},null,-1)),De={key:1,class:"text-success"},Me=o(()=>t("i",{class:"bi bi-check-circle ms-1"},null,-1)),Te=o(()=>t("i",{class:"bi bi-chevron-right ms-1"},null,-1)),qe={__name:"PaymentView",setup(v){const g=at(),B=ot(),F=lt(),{apiResAlert:L,apiErrAlert:j}=F,P=nt(),{finalTotal:O}=dt(P),{fetchOrder:E,fetchCheckout:z}=bt(),c=rt({});function G(){E(g.params.orderId).then(d=>{c.value=d.data.order}).catch(d=>j(d.response.data.message))}function J(){z(g.params.orderId).then(d=>{L(d.data.message),B.push(`/checkout/${g.params.orderId}`)}).catch(d=>j(d.response.data.message))}it(()=>{G()});const{paymentSchema:X}=ht(),H={payment:{type:"貨到付款"}},{handleSubmit:K,defineField:f,errors:n,meta:U}=yt({validationSchema:X,initialValues:H}),[b,I]=f("payment.type"),[w,Q]=f("payment.creditCard.name"),[x,W]=f("payment.creditCard.number"),[k,Y]=f("payment.creditCard.month"),[C,Z]=f("payment.creditCard.day"),[V,tt]=f("payment.creditCard.cvv"),et=K(()=>{J()});function st(d){let a=d.target.value.replace(/\D/g,"");a.length>16&&(a=a.slice(0,16));const h=a.replace(/(\d{4})(?=\d)/g,"$1 ");d.target.value=h,x.value=h}return(d,a)=>{var N,R,$,D;const h=ct("RouterLink");return i(),p(A,null,[S(vt),t("div",wt,[t("ul",kt,[t("li",Ct,[S(h,{to:"/",class:"nav-link link-gray-800 text-decoration-underline link-offset-1 px-2 py-0"},{default:M(()=>[r(" 首頁 ")]),_:1})]),Vt,t("li",St,[S(h,{to:"#",class:"nav-link link-gray-800 px-2 py-0 disabled"},{default:M(()=>[r("結帳")]),_:1})])]),At]),jt,t("div",Ut,[t("div",It,[t("div",Nt,[t("div",Rt,[t("table",$t,[Dt,t("tbody",null,[(i(!0),p(A,null,T(c.value.products,e=>(i(),p("tr",{key:e.id},[t("td",null,[t("img",{src:e.product.imageUrl,class:"mx-auto my-2",alt:"",width:"100"},null,8,Mt)]),t("td",null,[t("p",Tt,l(e.product.title),1),t("span",qt,l(e.product.content),1)]),t("td",null,l(`X${e.qty}`),1),t("td",Bt,l(`NT$ ${e.total}`),1)]))),128))])])])])]),t("div",Ft,[(i(!0),p(A,null,T(c.value.products,e=>(i(),ut(xt,{class:"mb-3",editor:!1,key:e.id,title:e.product.title,price:e.total,qty:e.qty,img_url:e.product.imageUrl,content:e.product.content},null,8,["title","price","qty","img_url","content"]))),128))]),t("div",Lt,[t("div",Pt,[t("div",Ot,[Et,t("div",zt,[t("div",Gt,[m(t("input",u({class:"form-check-input",type:"radio",name:"payment",id:"creditCard",value:"信用卡","data-bs-toggle":"list",href:"#credit-list","onUpdate:modelValue":a[0]||(a[0]=e=>_(b)?b.value=e:null)},s(I)),null,16),[[q,s(b)]]),Jt]),t("div",Xt,[m(t("input",u({class:"form-check-input",type:"radio",name:"payment",id:"cost",value:"貨到付款","data-bs-toggle":"list",href:"#cost-list","onUpdate:modelValue":a[1]||(a[1]=e=>_(b)?b.value=e:null)},s(I)),null,16),[[q,s(b)]]),Ht]),t("span",Kt,l(s(n)["payment.type"]),1)]),t("div",Qt,[t("div",Wt,[t("div",Yt,[Zt,m(t("input",u({type:"text",class:["form-control",{"is-invalid":s(n)["payment.creditCard.name"]}],id:"credit-name",placeholder:"請輸入持卡本人姓名","onUpdate:modelValue":a[2]||(a[2]=e=>_(w)?w.value=e:null)},s(Q)),null,16),[[y,s(w)]]),t("span",te,l(s(n)["payment.creditCard.name"]),1)]),t("div",ee,[se,m(t("input",u({type:"tel",class:["form-control",{"is-invalid":s(n)["payment.creditCard.number"]}],id:"credit-number",placeholder:"請輸入卡片16位號碼","onUpdate:modelValue":a[3]||(a[3]=e=>_(x)?x.value=e:null)},s(W),{onInput:a[4]||(a[4]=e=>st(e))}),null,16),[[y,s(x)]]),t("span",ae,l(s(n)["payment.creditCard.number"]),1)]),t("div",oe,[t("div",le,[ne,m(t("input",u({type:"tel",class:["form-control",{"is-invalid":s(n)["payment.creditCard.month"]}],id:"credit-month",placeholder:"MM",maxlength:"2","onUpdate:modelValue":a[5]||(a[5]=e=>_(k)?k.value=e:null)},s(Y)),null,16),[[y,s(k)]]),t("span",de,l(s(n)["payment.creditCard.month"]),1)]),t("div",re,[ie,m(t("input",u({type:"tel",class:["form-control",{"is-invalid":s(n)["payment.creditCard.day"]}],id:"credit-month",placeholder:"DD",maxlength:"2","onUpdate:modelValue":a[6]||(a[6]=e=>_(C)?C.value=e:null)},s(Z)),null,16),[[y,s(C)]]),t("span",ce,l(s(n)["payment.creditCard.day"]),1)]),t("div",pe,[me,m(t("input",u({type:"tel",class:["form-control",{"is-invalid":s(n)["payment.creditCard.cvv"]}],id:"credit-cvv",placeholder:"CVV",maxlength:"3","onUpdate:modelValue":a[7]||(a[7]=e=>_(V)?V.value=e:null)},s(tt)),null,16),[[y,s(V)]]),t("span",ue,l(s(n)["payment.creditCard.cvv"]),1)])])]),_e])])]),t("div",fe,[t("div",be,[t("ul",he,[t("li",ye,[ve,t("span",null,l((N=c.value.user)==null?void 0:N.name),1)]),t("li",xe,[ge,t("span",null,l((R=c.value.user)==null?void 0:R.tel),1)]),t("li",we,[ke,t("span",Ce,l(($=c.value.user)==null?void 0:$.email),1)]),t("li",Ve,[Se,t("span",Ae,l((D=c.value.user)==null?void 0:D.address),1)]),t("li",je,[Ue,t("span",Ie,l(`NT$ ${s(O)}`),1)])]),s(U).touched?(i(),p("div",Ne,[s(U).valid?(i(),p("span",De,[r(" 欄位已完成 "),Me])):(i(),p("span",Re,[r(" 欄位未完成 "),$e]))])):pt("",!0),t("button",{type:"button",class:"btn btn-primary w-100",onClick:a[8]||(a[8]=e=>s(et)())},[r(" 確認付款 "),Te])])])])])],64)}}},ze=gt(qe,[["__scopeId","data-v-843fa512"]]);export{ze as default};
