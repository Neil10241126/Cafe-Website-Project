import{k as X,D as Y,s as Z,l as c,z as L,r as ss,o as p,c as u,e as g,d as s,i as m,t as l,g as t,F as O,j as F,I as b,w as es,n as ts,O as os}from"./index-e-kLE5WB.js";import{_}from"./dashboard-icons-tCq6vBQ4.js";import{M as S}from"./modal-FBL1wkSJ.js";import{_ as ns}from"./LoadingUi-YdW-FvWX.js";import{_ as D}from"./DeleteModal-S5GZPLYd.js";import{u as ls}from"./useTimeformate-Oj4-TKDD.js";import{u as as}from"./order-4qRV4fQU.js";const j=_+"#fig-dots-vertical",ds=_+"#fig-filter",I=_+"#fig-trash",is=_+"#fig-pen",cs=_+"#fig-left",rs=_+"#fig-right",_s={class:"row gy-3 mb-3 mb-md-4"},hs={class:"col-12 col-md-8"},ps={class:"card"},us={class:"card-header d-flex justify-content-between px-md-4"},ms=s("div",null,[s("h3",{class:"fs-6 text-db-netural lh-base mb-0"},"每日銷售排行"),s("span",{class:"text-db-netural-dark"},"列出最高前五名商品。")],-1),fs=s("svg",{width:"24",height:"24",class:"text-db-netural-dark"},[s("use",{"xlink:href":j})],-1),gs=s("ul",{class:"dropdown-menu"},[s("li",null,[s("a",{class:"dropdown-item",href:"#"},"Action")]),s("li",null,[s("a",{class:"dropdown-item",href:"#"},"Another action")]),s("li",null,[s("a",{class:"dropdown-item",href:"#"},"Something else here")])],-1),bs=[fs,gs],vs={class:"card-body px-md-4"},xs={ref:"lineElement",class:"",style:{height:"245px"}},ws={class:"col-12 col-md-4"},ks={class:"card"},ys={class:"card-header d-flex justify-content-between px-md-4"},As=s("div",null,[s("h3",{class:"fs-6 text-db-netural lh-base mb-0"},"服務數據"),s("span",{class:"text-db-netural-dark"},"評分由 1 ~ 5 平均")],-1),$s=ts('<svg width="24" height="24" class="text-db-netural-dark"><use xlink:href="'+j+'"></use></svg><ul class="dropdown-menu"><li><a class="dropdown-item" href="#">Action</a></li><li><a class="dropdown-item" href="#">Another action</a></li><li><a class="dropdown-item" href="#">Something else here</a></li></ul>',2),Os=[$s],Ms={class:"card-body px-md-4"},Cs={ref:"pieElement",style:{height:"245px"}},Es={class:"card"},Ls={class:"card-header d-flex justify-content-between px-md-4"},Fs=s("h3",{class:"fs-6 text-db-netural lh-base mb-0"},"所有訂單",-1),Ss={class:"text-db-netural-dark"},Ds={class:"d-flex align-items-center"},js=s("button",{type:"button",class:"btn btn-outline-netural me-2"},[s("svg",{width:"20",height:"20"},[s("use",{"xlink:href":ds})]),s("span",{class:"d-none d-md-block ms-2"},"篩選")],-1),Is=s("svg",{width:"20",height:"20"},[s("use",{"xlink:href":I})],-1),Ns=s("span",{class:"d-none d-md-block ms-2"},"全部刪除",-1),Rs=[Is,Ns],Bs={class:"card-body table-responsive px-md-4"},Vs={class:"table table-db-background-light"},zs=s("thead",{class:"align-middle text-nowrap"},[s("tr",null,[s("th",{scope:"col",class:"fw-normal py-3 pe-3"},"項次"),s("th",{scope:"col",class:"fw-normal pe-3"},"訂單編號 ( ID )"),s("th",{scope:"col",class:"fw-normal pe-3"},"生成時間"),s("th",{scope:"col",class:"fw-normal pe-3"},"商品數量"),s("th",{scope:"col",class:"fw-normal pe-3"},"是否付款"),s("th",{scope:"col",class:"fw-normal text-end pe-3"},"是否出貨"),s("th",{scope:"col",class:"fw-normal text-end pe-0"},"操作")])],-1),Ps={class:"align-middle text-nowrap"},Ts={scope:"row",class:"pt-3 pe-3 border-0"},qs={class:"pt-3 pe-3 border-0"},Gs={style:{width:"200px"}},Hs={class:"mb-0 text-truncate"},Js={class:"pt-3 pe-3 border-0"},Ks={class:"pt-3 pe-3 border-0"},Qs={class:"pt-3 pe-3 border-0"},Us={class:"pt-3 pe-3 border-0 text-end"},Ws={class:"tag tag-success"},Xs={class:"pt-3 pe-0 border-0"},Ys={class:"d-flex justify-content-end"},Zs=s("svg",{width:"14",height:"14",class:"me-1"},[s("use",{"xlink:href":is})],-1),se=s("span",{class:"fs-9"},"編輯",-1),ee=["onClick"],te=s("svg",{width:"14",height:"14",class:"me-1"},[s("use",{"xlink:href":I})],-1),oe=s("span",{class:"fs-9"},"刪除",-1),ne=[te,oe],le={class:"card-footer bg-transparent border-top-0 px-md-4 d-flex justify-content-end"},ae={"aria-label":"Page navigation example"},de={class:"pagination"},ie={class:"page-item"},ce=s("svg",{width:"16",height:"16"},[s("use",{"xlink:href":cs})],-1),re=[ce],_e=["onClick"],he={class:"page-item"},pe=s("svg",{width:"16",height:"16"},[s("use",{"xlink:href":rs})],-1),ue=[pe],ye={__name:"AdminOrders",setup(me){const{fetchAdminOrders:N,fetchDelAdminOrder:R,fetchDelAdminOrderAll:B}=os(),{timeFormate:V}=ls(),z=X(),{apiResAlert:M,apiErrAlert:v}=z,P=Y(),{isLoadingOn:x,isLoadingOff:w}=P,T=as(),{tempOrder:q}=Z(T),{orders:k,orderID:y,pagination:a,getAdminOrders:A,deleteAdminOrder:G,deleteAdminOrdersAll:H}=J();function J(){const r=c([]),o=c(""),d=c({});async function e(i=1){x("isFullLoading");try{const{data:n}=await N(i);d.value=n.pagination,r.value=n.orders}catch(n){const{data:h,status:$}=n.response;v(`${$} ${h.message}`)}finally{w("isFullLoading")}}async function f(i){x("isFullLoading");try{const n=await R(i);M(n.data.message),e()}catch(n){const{data:h,status:$}=n.response;v(`${$} ${h.message}`)}finally{C.value.hide(),w("isFullLoading")}}async function W(){x("isFullLoading");try{const{data:i}=await B();M(i.message),e()}catch(i){const{data:n,status:h}=i.response;v(`${h} ${n.message}`)}finally{E.value.hide(),w("isFullLoading")}}return L(()=>e()),{orders:r,orderID:o,pagination:d,getAdminOrders:e,deleteAdminOrder:f,deleteAdminOrdersAll:W}}const{delModalEl:K,delModalAllEl:Q,delModal:C,delModalAll:E}=U();function U(){const r=c(null),o=c(null),d=c(""),e=c("");return L(()=>{d.value=new S(r.value.$el),e.value=new S(o.value.$el)}),{delModalEl:r,delModalAllEl:o,delModal:d,delModalAll:e}}return(r,o)=>{const d=ss("RouterLink");return p(),u(O,null,[g(ns),s("div",_s,[s("div",hs,[s("div",ps,[s("div",us,[ms,s("a",{href:"#",class:"h-100","data-bs-toggle":"dropdown",onClick:o[0]||(o[0]=m(()=>{},["prevent"]))},bs)]),s("div",vs,[s("div",xs,null,512)])])]),s("div",ws,[s("div",ks,[s("div",ys,[As,s("a",{href:"#",class:"h-100","data-bs-toggle":"dropdown",onClick:o[1]||(o[1]=m(()=>{},["prevent"]))},Os)]),s("div",Ms,[s("div",Cs,null,512)])])])]),s("div",Es,[s("div",Ls,[s("div",null,[Fs,s("span",Ss,"總計 "+l(t(k).length)+" 筆",1)]),s("div",Ds,[js,s("button",{type:"button",class:"btn btn-danger",onClick:o[2]||(o[2]=e=>t(E).show())},Rs)])]),s("div",Bs,[s("table",Vs,[zs,s("tbody",Ps,[(p(!0),u(O,null,F(t(k),e=>(p(),u("tr",{key:e.id},[s("td",Ts,l(e.num),1),s("td",qs,[s("div",Gs,[s("p",Hs,l(e.id),1)])]),s("td",Js,l(t(V)(t(k).create_at)),1),s("td",Ks,l(Object.keys(e.products).length)+" 件",1),s("td",Qs,[s("span",{class:b(["tag tag-success",{"tag-danger":!e.is_paid}])},l(e.is_paid?"已付款":"未付款"),3)]),s("td",Us,[s("span",Ws,l(e.is_paid?"已出貨":"未出貨"),1)]),s("td",Xs,[s("div",Ys,[g(d,{to:`/admin/orders/${e.id}`,class:"btn btn-primary me-1",onClick:f=>q.value={...e}},{default:es(()=>[Zs,se]),_:2},1032,["to","onClick"]),s("button",{type:"button",class:"btn btn-danger",onClick:f=>(t(C).show(),y.value=e.id)},ne,8,ee)])])]))),128))])])]),s("div",le,[s("nav",ae,[s("ul",de,[s("li",ie,[s("a",{class:b(["page-link",{disabled:!t(a).has_pre}]),onClick:o[3]||(o[3]=m(e=>t(A)(t(a).current_page-1),["prevent"])),href:"#","aria-label":"Previous"},re,2)]),(p(!0),u(O,null,F(t(a).total_pages,e=>(p(),u("li",{key:e+"123",class:"page-item"},[s("a",{class:b(["page-link",[{active:e===t(a).current_page},{disabled:e===t(a).current_page}]]),href:"#",onClick:m(f=>t(A)(e),["prevent"])},l(e),11,_e)]))),128)),s("li",he,[s("a",{class:b(["page-link",{disabled:!t(a).has_next}]),href:"#","aria-label":"Next",onClick:o[4]||(o[4]=m(e=>t(A)(t(a).current_page+1),["prevent"]))},ue,2)])])])])]),g(D,{ref_key:"delModalEl",ref:K,title:"刪除訂單",content:t(y),onDeleteEmit:o[5]||(o[5]=e=>t(G)(t(y)))},null,8,["content"]),g(D,{ref_key:"delModalAllEl",ref:Q,title:"刪除全部訂單",content:"全部訂單",onDeleteEmit:o[6]||(o[6]=e=>t(H)())},null,512)],64)}}};export{ye as default};
